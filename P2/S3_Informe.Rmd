---
author: "Mauricio Rodriguez, Renato Rodriguez, Sebastian Quispe, Christian Salazar, Frings Barrueta" 
title: "Impacto del proceso de vacunación contra la Covid-19"
date: "June 9th 2021"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: journal
---
# Cargar librerias 
```{r}
library(readr)
library(dplyr)
library (ggplot2)
library(stringr)
library(scales)
library(lubridate)
library(modeest)
library(viridis)
``` 

# Asignar DF's con los datos RAW de los archivos
```{r}
DFFallecidosRAW <- read_csv("fallecidos.csv")
DFVacunadosRAW <- read_csv("vacunados.csv")
```

# Limpieza tabla DFFallecidos
```{r echo = FALSE}
DFFallecidosCLEAN<-subset(DFFallecidosRAW,select = -c(FECHA_CORTE,UUID,UBIGEO,PROVINCIA,DISTRITO))

DFFallecidosCLEAN %>% rename("EDAD"= "EDAD_DECLARADA")-> DFFallecidosCLEAN

vector<-DFFallecidosCLEAN$FECHA_FALLECIMIENTO
dia<-str_sub(vector,-2,-1) #dia
mes<-str_sub(vector,-4,-3) #mes
anio<-str_sub(vector, end = 4) #anio
date = paste(anio,"-",mes,"-",dia, sep = "")
DFFallecidosCLEAN$FECHA_FALLECIMIENTO<- lubridate::ymd(date)
DFFallecidosCLEAN<-filter(DFFallecidosCLEAN,SEXO != "INDETERMINADO")
```

# Limpieza tabla DFVacunados
```{r echo = FALSE}
DFVacunadosCLEAN<-subset(DFVacunadosRAW,select = -c(FECHA_CORTE,UUID,DIRESA,PROVINCIA,DISTRITO))
DFVacunadosCLEAN %>% rename("GRUPO"="GRUPO_RIESGO")-> DFVacunadosCLEAN

vector<-DFVacunadosCLEAN$FECHA_VACUNACION
dia<-str_sub(vector,-2,-1) #dia
mes<-str_sub(vector,-4,-3) #mes
anio<-str_sub(vector, end = 4) #anio
date = paste(anio,"-",mes,"-",dia, sep = "")
DFVacunadosCLEAN$FECHA_VACUNACION<- lubridate::ymd(date)
```


# Figuras de Mérito

## Dataset FALLECIDOS

### FECHA_FALLECIMIENTO
HIPÓTESIS: ¿Cómo influye la llegada de las vacunas en la cantidad de fallecidos por COVID?
En lo que va la llegada de las vacunas, el pico más alto de la cantidad de fallecidos fue obtenido durante este periodo.

```{r, echo=FALSE}
DFFechaFallecidos <- as.data.frame(table(DFFallecidosCLEAN$FECHA_FALLECIMIENTO))
ggplot(data = DFFallecidosCLEAN, aes(FECHA_FALLECIMIENTO)) + 
  geom_freqpoly() + 
  scale_x_date(date_minor_breaks = "1 day", date_labels = "%b %d") +
  labs(title = "Polígono de dispersión de fallecidos por COVID-19",
       x = "Fecha",
       y = "Cantidad de fallecidos")
```

### EDAD
HIPÓTESIS: ¿Será cierto que los adultos mayores son las personas que mas fallecieron por COVID?
El rango de edades de la mayor cantidad de personas que fallecieron por COVID está entre 60 y 80 años. 

```{r, echo=FALSE}
ggplot(data = DFFallecidosCLEAN, aes(x=EDAD)) + 
  geom_histogram(aes(fill=..count..)) + 
  scale_fill_viridis("Frecuencia", discrete=F) + 
  labs(title="Edades de personas fallecidas por COVID-19",
       x="Edad(años)",
       y="Frecuencia")
```

### SEXO
HIPÓTESIS: ¿Existe alguna diferencia entre la cantidad de fallecidos y su género?
En el Perú, la gran mayoría de personas fallecidas por COVID son hombres.

```{r, echo=FALSE}
options(scipen=999)
barplot(table(DFFallecidosCLEAN$SEXO),
        main="Sexo de personas fallecidas por COVID-19",
        col=c("orange", "blue"),
        legend.text=c("Mujeres", "Hombres"),
        ylim = c(0,150000),
        ylab = "Frecuencia"
)
```


### DEPARTAMENTO
HIPÓTESIS:¿Es cierto que los departamentos del Norte tienen la mayor cantidad de fallecidos por COVID?
A partir de los gráficos, Lima es la ciudad con mayor cantidad de fallecidos por COVID

```{r, echo=FALSE}
ggplot(data = DFFallecidosCLEAN, aes(x=DEPARTAMENTO)) + 
  geom_histogram(aes(fill=..count..), stat = "count") + 
  scale_fill_viridis("Frecuencia", discrete=F) + 
  labs(title="Departamentos de fallecidos por COVID-19",
       x="Departamento",
       y="Frecuencia")
```

## Dataset PROCESO DE VACUNACIÓN

### FECHA_VACUNACION x EDAD
HIPÓTESIS:¿Es cierto que la género de?

```{r}

```


### SEXO
HIPÓTESIS: ¿Es cierto que el género de la mayor cantidad de personas vacunadas es el mismo que de las personas fallecidas?
No, observamos que la mayor cantidad de personas vacunadas son mujeres.

```{r, echo=FALSE}
options(scipen=999)
barplot(table(DFVacunadosCLEAN$SEXO),
        main="Sexo de personas vacunadas por COVID-19",
        col=c("orange", "blue"),
        legend.text=c("Mujeres", "Hombres"),
        ylim = c(0,2000000),
        ylab = "Frecuencia"
)
```

### DOSIS
HIPÓTESIS:¿Existe la misma cantidad de dosis aplicadas en las personas vacunadas del Perú?
No, la mayor cantidad de dosis aplicadas es la primera.

```{r, echo=FALSE}
ggplot(data = DFVacunadosCLEAN, aes(x=DOSIS)) + 
  geom_histogram(aes(fill=..count..), stat = "count") + 
  scale_fill_viridis("Frecuencia", discrete=F) + 
  labs(title="Dosis de vacunas por COVID-19",
       x="Dosis",
       y="Frecuencia")
```

### FABRICANTE
HIPÓTESIS:
¿Será el mayor fabricante de vacunas del mundo (AstraZeneca) el que distribuye mayor cantidad de vacunas al Perú?
El fabricante que más cantidad de vacunas distribuye al Perú es Pfizer.

```{r, echo=FALSE}
ggplot(data = DFVacunadosCLEAN, aes(x=FABRICANTE)) + 
  geom_histogram(aes(fill=..count..), stat = "count") + 
  scale_fill_viridis("Frecuencia", discrete=F) + 
  labs(title="Fabricantes de vacunas por COVID-19",
       x="Fabricante",
       y="Frecuencia")
```

### DEPARTAMENTO
HIPÓTESIS:
¿Es cierto que el departamento con la mayor cantidad de personas vacunadas es el mismo que de las personas fallecidas?
Si, es cierto el departamento con mayor cantidad de personas vacunadas es Lima.

```{r, echo=FALSE}
ggplot(data = DFVacunadosCLEAN, aes(x=DEPARTAMENTO)) + 
  geom_histogram(aes(fill=..count..), stat = "count") + 
  scale_fill_viridis("Frecuencia", discrete=F) + 
  labs(title="Departamentos de vacunados por COVID-19",
       x="Departamento",
       y="Frecuencia")
```


